generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Role {
  superadmin
  admin
  employee
}

model User {
  id                  Int            @id @default(autoincrement())
  name                String
  email               String         @unique
  password            String
  role                Role           @default(employee)
  is_verified         Boolean        @default(false)

  profile_image       String?        // foto profil user
  last_login          DateTime?      // kapan terakhir login

  reset_token         String?
  reset_token_expired DateTime?

  created_at          DateTime       @default(now())
  updated_at          DateTime       @updatedAt

  notifications       Notification[]
  attendances         Attendance[]
  leaves              Leave[]
}

model Notification {
  id          Int      @id @default(autoincrement())
  user        User?    @relation(fields: [userId], references: [id])
  userId      Int?
  title       String
  message     String
  is_read     Boolean  @default(false)
  created_at  DateTime @default(now())
}

model Attendance {
  id         Int      @id @default(autoincrement())
  user       User     @relation(fields: [userId], references: [id])
  userId     Int
  date       DateTime
  clockIn    DateTime?
  clockOut   DateTime?
  status     String   // "On Time" | "Late" | "Absent"
  created_at DateTime @default(now())
}

model Leave {
  id         Int      @id @default(autoincrement())
  userId     Int
  user       User     @relation(fields: [userId], references: [id])
  type       String   // Annual, Sick, Unpaid
  startDate  DateTime
  endDate    DateTime
  days_taken Int      
  status     String   // Pending, Approved, Rejected
  created_at DateTime @default(now())
}

model AuditLog {
  id         Int      @id @default(autoincrement())
  actor      String   // siapa yang melakukan aksi
  action     String   // misalnya "UPDATE_USER_ROLE"
  details    String?
  created_at DateTime @default(now())
}
